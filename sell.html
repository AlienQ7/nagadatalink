<!DOCTYPE html>
<html>

<head>
    <title>OLX - Buy</title>
    <link rel="stylesheet" href="sell.css">
</head>

<body>
    <nav>
        <div class="nav__logo">
            <a href="./index.html">
                <svg viewBox="0 0 36.289 20.768" alt="Logo">
                    <path
                        d="M18.9 20.77V0h4.93v20.77zM0 10.39a8.56 8.56 0 1 1 8.56 8.56A8.56 8.56 0 0 1 0 10.4zm5.97-.01a2.6 2.6 0 1 0 2.6-2.6 2.6 2.6 0 0 0-2.6 2.6zm27 5.2l-1.88-1.87-1.87 1.88H25.9V12.3l1.9-1.9-1.9-1.89V5.18h3.27l1.92 1.92 1.93-1.92h3.27v3.33l-1.9 1.9 1.9 1.9v3.27z">
                    </path>
                </svg>
            </a>
        </div>
    </nav>
    <h1>POST YOUR AD</h1>
    <div class="sell_container">
        <div class="sell__inputs">
            <h4>INCLUDE SOME DETAILS</h4>
            <label for="name">Add Title</label>
            <input id="name" type="text">
            <label for="description">Description</label>
            <textarea id="description" cols="30" rows="10"></textarea>
            <label for="brand">Brand</label>
            <input id="brand" type="text">
            <div class="condition">
                <label for="condition">Condition : </label>
                <button>New</button>
                <button>Used</button>
            </div>
            <hr />
            <h4>SET A PRICE</h4>
            <label for="price">Price</label>
            <input id="price" type="text">
            <hr>
            <h4>Past Image Link</h4>
            <label for="image">Link</label>
            <input type="text" id="image">
            <hr />
            <h4>Your AD'S Location</h4>
            <label for="location">location</label>
            <input type="text" id="location">
            <hr>
            <h4>Review Your Account</h4>
            <div class="profileName">
                <img src="./images/avatar.png" alt="" width="70px">
                <div class="input">
                    <label for="ptofileName">Name</label>
                    <input type="text" id="ptofileName">
                </div>
            </div>
            <h4>Lets verify your Account</h4>
            <label for="ptofilePhone">Mobile Phone Number</label>
            <input type="text" id="ptofilePhone">
            <h4>Want to Show Phone Number Write Yes or No</h4>
            <label for="phoneYes">Yes Or No</label>
            <input type="text" id="phoneYes">

            <hr />
        </div>

        <button id="btnSubmit" onclick="addProduct()">Post Now</button>
    </div>
    <script>
  // Prefill from localStorage (no change)
  document.getElementById("ptofileName").value = (localStorage.getItem("name") || "").toUpperCase();
  document.getElementById("ptofilePhone").value = (localStorage.getItem("phone") || "").toUpperCase();

  // Handle submit
  async function addProduct() {
    const data = {
      title: document.getElementById("name").value,
      description: document.getElementById("description").value,
      category: document.getElementById("brand").value,
      location: document.getElementById("location").value,
      contact: document.getElementById("ptofilePhone").value + 
               (document.getElementById("phoneYes").value.toLowerCase() === "yes" ? " (public)" : " (hidden)")
    };

    if (!data.title || !data.contact) {
      alert("Please fill at least Title and Phone fields!");
      return;
    }

    try {
      const res = await fetch("/api/ads", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(data)
      });

      const result = await res.json();
      if (result.success) {
        alert("✅ Ad posted successfully!");
        window.location.href = "./index.html";
      } else {
        alert("❌ Failed to post ad!");
      }
    } catch (err) {
      alert("⚠️ Error: " + err);
    }
  }
</script>
</body>

</html>
